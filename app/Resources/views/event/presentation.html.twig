{% extends 'base.html.twig' %}


{% block body %}
    <link href="https://cdn.rawgit.com/sachinchoolur/lightgallery.js/master/dist/css/lightgallery.css" rel="stylesheet">

    <div class="row mt-lg-5">
        {% if event.images != null %}
            {% set arr_size = event.images|length %}
        {% endif %}
        <!--Product-->
        <div class="col-lg-7 wow fadeIn" data-wow-delay="0.2s">

            <!--Carousel Wrapper-->
            <div id="carousel-example-1z" class="carousel slide carousel-fade" data-ride="carousel">
                <!--Indicators-->

                <ol class="carousel-indicators">
                    {% if event.images != null %}
                        {% for i in range(0, arr_size-1) %} 
                            <li data-target="#carousel-example-1z" data-slide-to="{{i}}"></li>
                            {% endfor %}
                        {% endif %}
                </ol>

                <!--/.Indicators-->
                <!--Slides-->
                <div class="carousel-inner" role="listbox">
                    <!--First slide-->
                    <div class="carousel-item active">
                        {% if event.images != null %}
                            <img class="d-block w-100" src="{{asset('uploads/images/' ~ event.images[0])}}" alt="" style="width:635px;height:425px;">
                        {% endif %}
                    </div>
                    <!--/First slide-->

                    {% if (event.images != null) and (arr_size > 1) %}
                        {% for i in range(1, arr_size-1) %} 
                            <!--Other slide-->
                            <div class="carousel-item ">
                                <img class="d-block w-100" src="{{asset('uploads/images/' ~ event.images[i])}}" alt="" style="width:635px;height:425px;">
                            </div>
                            <!--/Other slide-->
                        {% endfor %}
                    {% endif %}

                </div>
                <!--/.Slides-->
                <!--Controls-->
                <a class="carousel-control-prev" href="#carousel-example-1z" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carousel-example-1z" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
                <!--/.Controls-->
            </div>
            <!--/.Carousel Wrapper-->

        </div>
        <!--/.Product-->

        <!--Info-->
        <div class="col-lg-5">

            <!--First row-->
            <div class="row wow fadeIn" data-wow-delay="0.4s">
                <div class="col-md-12">
                    <!--Product-->
                    <div class="product-wrapper">
                        {%set titre = event.titre %}
                        <!--Product data-->
                        <h2 class="h2-responsive mt-4 font-bold">{{event.titre}}</h2>
                        <hr>

                        <h2>
                            <span class="badge" style="background-color: #B579D2">{{event.prix}} €</span>
                        </h2>
                        <dl class="row mt-4">
                            <dt class="col-sm-4">Date de début</dt>
                            <dd class="col-sm-8">{{event.dateDebut|date("d/m/Y")}}</dd>

                            <dt class="col-sm-4">Date de fin</dt>
                            <dd class="col-sm-8">{{event.dateFin|date("d/m/Y")}}</dd>
                            <dt class="col-sm-4">Heures</dt>
                            <dd class="col-sm-8">De <strong>{{event.dateDebut|date("H:i")}} </strong> à <strong>{{event.dateFin|date("H:i")}} </strong> </dd>

                            <dt class="col-sm-4 text-truncate">Lieu</dt>
                            <dd class="col-sm-8">{{event.adresse}}</dd>
                        </dl>

                        <br>
                        {% if event.nbrParticipants == event.nbrMax %}
                        <a  class="btn btn-primary-atelier btn-md pull-right" >Complet</a>
                        {%else%}
                             <a  href="{{ path('order_new',{ 'amount': event.prix, 'event': event.id }) }}" class="btn btn-primary-atelier btn-md pull-right" >Participez</a>
                        {%endif%}
                    </div>
                    <!--Product-->

                </div>
            </div>
            <!--/.First row-->

        </div>
        <!--/.Info-->


        <div class="col-lg-12">
            <br>
            <h2> Description </h2>
            
            {{event.description|raw}}

        </div>
        {# gallery#}
        {#{% if (event.images != null) and (arr_size > 1) %}#}
        <div class="col-lg-12">
            <br><br>
            <h2>Galerie de photos </h2>

            <ul id="mdb-lightbox-ui" class="list-unstyled row">
                {% for image in event.images %} 
                    <li class="col-xs-6 col-sm-4 col-md-3" data-responsive="{{asset('uploads/images/' ~ image)}}" data-src="{{asset('uploads/images/' ~ image)}}" data-sub-html="<h4>{{titre}}</h4>" data-pinterest-text="Pin it1" data-tweet-text="share on twitter 1">
                        <a href="">
                            <img class="img-responsive" src="{{asset('uploads/images/' ~ image)}}" style="width:282px;height:188px;" alt="Thumb-1">
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {#{%endif%}#}
        {# gallery#}

        <!--Reviews-->
        <div class="col-lg-12">
            <hr>
            <div id="map" style="height: 300px"></div>
            <div class="media wow fadeIn" data-wow-delay="0.2s">
                <!--      <h4><strong>Description</strong></h4>
                      <p> </p>
                  </div>-->
                <hr>
                <!--Share with social media-->
            </div>
            <!--/.Reviews-->

        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


        <script src="https://cdn.jsdelivr.net/picturefill/2.3.1/picturefill.min.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lightgallery.js/master/dist/js/lightgallery.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-pager.js/master/dist/lg-pager.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-autoplay.js/master/dist/lg-autoplay.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-fullscreen.js/master/dist/lg-fullscreen.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-zoom.js/master/dist/lg-zoom.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-hash.js/master/dist/lg-hash.js"></script>
        <script src="https://cdn.rawgit.com/sachinchoolur/lg-share.js/master/dist/lg-share.js"></script>
        <script>
            lightGallery(document.getElementById('mdb-lightbox-ui'));
        </script>    


    {% endblock %}

    {% block javascripts %}

        <script type="text/javascript">
            function initMap() {
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 14,

                });
                var geocoder = new google.maps.Geocoder();
                geocodeAddress(geocoder, map);
            }

            function geocodeAddress(geocoder, resultsMap) {
                var address = '{{event.adresse}},  ' + '{{event.ville}}';
                var title = '{{event.titre}}';
                geocoder.geocode({'address': address}, function (results, status) {
                    if (status === 'OK') {
                        resultsMap.setCenter(results[0].geometry.location);
                        var marker = new google.maps.Marker({
                            map: resultsMap,
                            position: results[0].geometry.location,
                            title: '{{event.titre}}',
                            animation: google.maps.Animation.DROP,
                            address: '{{event.adresse}}',
                        })
                        infoWindow(marker, map, title, address);
                    } else {
                        alert('Geocode was not successful for the following reason: ' + status);
                    }
                });
            }
            var iw;
            function infoWindow(marker, map, title, address) {
                google.maps.event.addListener(marker, 'click', function () {
                    var html = "<div><h3>" + title + "</h3><p>" + address + "<br></div> ";
                    iw = new google.maps.InfoWindow({
                        content: html,
                        maxWidth: 350
                    });
                    iw.open(map, marker);
                });
                google.maps.event.addListener(marker, 'click', function () {

                    // iw.close();
                });

            }

        </script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBdI6hYrzRf5QMgKGj8RQsEeLE9bS-1vOQ&callback=initMap">

        </script>


    {% endblock %}
